package emsbase

import (
	log "github.com/thinkboy/log4go"
)

type Portfolio struct {
	SecurityEntrusts []Entrust
	FutureEntrusts   []Entrust
	StrategyName     string             // 策略名称
	ProdID           string             // 产品ID
	CombiNo          string             // 组合编号
	StockAcc         string             // 证券账户
	FutureAcc        string             // 期货账户
	AccountID        string             // 对接第三方系统账户
	AdapterName      string             // 交易Adapter
	TacticID         string             // 策略ID
	Algorithm        string             // 算法
	Params           map[string]float64 // 算法交易参数
}

type Entrust struct {
	MarkerNo      string  // 市场代码
	StockCode     string  // 证券代码（带交易所后缀）
	TradeCode     string  // 证券代码
	Price         float64 // 委托价格
	Vol           int     // 委托数量
	OpenCloseFlag int     // 开平标记 1：开，2：平
	BS            int     // 买卖方向 1：买，2：卖
	TimeStamp     int64   // 订单生成时间戳
	Remark        string  // 备注信息
	ID            int64   // 用于标识订单
}

type EntrustType struct {
	OpenCloseFlag int // 开平标记 1：开，2：平
	BS            int // 买卖方向 1：买，2：卖
}

const QUANT_EMS_DO_NOTHING int = 0
const QUANT_EMS_OPEN int = 1
const QUANT_EMS_CLOSE int = 2
const QUANT_EMS_BUY int = 1
const QUANT_EMS_SELL int = 2

const QUANT_EMS_OPEN_LONG int = 1
const QUANT_EMS_OPEN_SHORT int = 2
const QUANT_EMS_CLOSE_LONG int = 3
const QUANT_EMS_CLOSE_SHORT int = 3

var EntrustTypeMap map[int]EntrustType

func init() {
	log.Info("Init emsmodule/base package")
	EntrustTypeMap = make(map[int]EntrustType)
	EntrustTypeMap[QUANT_EMS_OPEN_LONG] = EntrustType{QUANT_EMS_OPEN, QUANT_EMS_BUY}
	EntrustTypeMap[QUANT_EMS_OPEN_SHORT] = EntrustType{QUANT_EMS_OPEN, QUANT_EMS_SELL}
	EntrustTypeMap[QUANT_EMS_CLOSE_LONG] = EntrustType{QUANT_EMS_CLOSE, QUANT_EMS_BUY}
	EntrustTypeMap[QUANT_EMS_CLOSE_SHORT] = EntrustType{QUANT_EMS_CLOSE, QUANT_EMS_SELL}
}

type ITarde interface {
	Init() int
	LimitEntrust(e Entrust, AccountCode, ComiNo string)
	QueryPos(AccountCode string, ComiNo string)
	QueryAccount(AccountCode string, ComiNo string)
	QueryEntrustByAcc(AccountCode string, ComiNo string)
	QueryEntrustByEntrustNo(AccountCode string, ComiNo string, EntrustNo int)
}
